# Simplified Steering Controller for ST3125 Servo
# Handles articulated wheel loader steering with slip compensation

module_name: Steering Controller

parameters:
    # Basic control parameters
    - group: Basic Control
      definitions:
        STEER_MAX_ANGLE:
            description:
                short: Maximum steering angle
                long: Maximum allowed steering angle in radians (±45° = ±0.785 rad)
            type: float
            default: 0.785398
            min: 0.1
            max: 1.57
            unit: rad
            decimal: 3

        STEER_MAX_RATE:
            description:
                short: Maximum steering rate
                long: Maximum steering angular velocity in rad/s (60°/s = 1.047 rad/s)
            type: float
            default: 1.047198
            min: 0.1
            max: 3.14
            unit: rad/s
            decimal: 3

        STEER_DEADBAND:
            description:
                short: Steering deadband
                long: Deadband around target position to reduce jitter
            type: float
            default: 0.00873
            min: 0.0
            max: 0.1
            unit: rad
            decimal: 5

        STEER_TRIM:
            description:
                short: Steering trim offset
                long: Constant offset added to steering commands for calibration
            type: float
            default: 0.0
            min: -0.2
            max: 0.2
            unit: rad
            decimal: 4

        STEER_REVERSE:
            description:
                short: Reverse steering direction
                long: Invert steering direction if servo is mounted backwards
            type: bool
            default: false

    # Slip compensation parameters
    - group: Slip Compensation
      definitions:
        STEER_SLIP_COMP_EN:
            description:
                short: Enable slip compensation
                long: Use PredictiveTraction data for slip-based steering compensation
            type: bool
            default: true

        STEER_SLIP_COMP_GAIN:
            description:
                short: Slip compensation gain
                long: Gain for slip-based steering compensation
            type: float
            default: 0.5
            min: 0.0
            max: 2.0
            decimal: 2

        STEER_SLIP_COMP_MAX:
            description:
                short: Maximum slip compensation
                long: Maximum slip compensation angle in radians
            type: float
            default: 0.174533
            min: 0.0
            max: 0.5
            unit: rad
            decimal: 4

    # Feedforward control parameters
    - group: Feedforward Control
      definitions:
        STEER_FF_GAIN:
            description:
                short: Feedforward gain
                long: Feedforward gain for improved dynamic response
            type: float
            default: 0.2
            min: 0.0
            max: 1.0
            decimal: 2

        STEER_FF_SPEED_SCALE:
            description:
                short: Speed-dependent feedforward scaling
                long: Scaling factor for speed-dependent feedforward control
            type: float
            default: 0.1
            min: 0.0
            max: 0.5
            decimal: 2

    # ST3125 servo parameters
    - group: ST3125 Servo
      definitions:
        STEER_PWM_MIN:
            description:
                short: Servo minimum PWM
                long: Minimum PWM value for servo (deprecated - kept for compatibility)
            type: float
            default: 1000.0
            min: 500.0
            max: 1500.0
            unit: us

        STEER_PWM_MAX:
            description:
                short: Servo maximum PWM
                long: Maximum PWM value for servo (deprecated - kept for compatibility)
            type: float
            default: 2000.0
            min: 1500.0
            max: 2500.0
            unit: us

        STEER_CURR_LIMIT:
            description:
                short: Servo current limit
                long: Maximum current limit for ST3125 servo
            type: float
            default: 2.0
            min: 0.5
            max: 5.0
            unit: A
            decimal: 1
